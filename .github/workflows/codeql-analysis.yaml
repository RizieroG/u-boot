name: CodeQL with Prebuilt DB

on:
  workflow_dispatch:

jobs:
  analyze:
    name: Run CodeQL analysis on prebuilt database
    runs-on: ubuntu-latest

    steps:
    - name: Checkout query repo
      uses: actions/checkout@v4

    - name: Download CodeQL database
      run: |
        curl -L -o u-boot-codeql.zip https://github.com/github/securitylab/releases/download/u-boot-codeql-database/u-boot_u-boot_cpp-srcVersion_d0d07ba86afc8074d79e436b1ba4478fa0f0c1b5-dist_odasa-2019-07-25-linux64.zip
        unzip u-boot-codeql.zip -d uboot-db

    - name: Setup CodeQL CLI
      uses: github/codeql-action/init@v3
      with:
        languages: cpp

    - name: Run CodeQL analysis
      uses: github/codeql-action/analyze@v3
      with:
        database: ./uboot-db
        queries: ./queries-static-analysis
